"use strict";(self["webpackChunkbizMOB4Vue"]=self["webpackChunkbizMOB4Vue"]||[]).push([[9810],{90987:function(e,i,t){t.d(i,{l:function(){return l}});class l{countFileSize(e){const i=["B","kB","MB","GB","TB"],t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,t)).toFixed(2)} ${i[t]}`}}},9810:function(e,i,t){t.r(i),t.d(i,{default:function(){return $}});var l=t(66252),s=t(3577);const a=e=>((0,l.dD)("data-v-6db68bad"),e=e(),(0,l.Cn)(),e),o={class:"tab_cont"},n={class:"row gap"},d={class:"col"},h={class:"form01"},f={class:"row gap10"},r={class:"col"},c={class:"upload_box ico"},u=a((()=>(0,l._)("span",{class:"extention"},null,-1))),p={class:"col auto"},m=["v-model","disabled"];function g(e,i){const t=(0,l.up)("ion-label"),a=(0,l.up)("ion-button");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",n,[(0,l._)("div",d,[(0,l._)("dl",h,[(0,l._)("dt",null,(0,s.zw)(e.$t("cib201003ss12.attach_file")),1),(0,l._)("dd",null,[(0,l._)("div",f,[(0,l._)("div",r,[(0,l._)("div",c,[e.isShowPlaceholder?((0,l.wg)(),(0,l.j4)(t,{key:0,class:"placeholder file"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("cib201003ss12.please_upload_the_file")),1)])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(t,{class:"filename"},{default:(0,l.w5)((()=>[(0,l._)("strong",null,(0,s.zw)(e.fileName),1),u])),_:1}),e.removeFileButton?((0,l.wg)(),(0,l.j4)(a,{key:1,class:"btn_remove",onClick:i[0]||(i[0]=i=>e.handleRemoveFile())},{default:(0,l.w5)((()=>[(0,l.Uk)("remove")])),_:1})):(0,l.kq)("",!0)])]),(0,l._)("div",p,[(0,l._)("input",{class:"btn02",id:"actual-btn",ref:"uploadInput",type:"file","v-model":e.fileInfo.fileId,accept:".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf",onChange:i[1]||(i[1]=i=>e.handleUploadFile(i)),disabled:!e.isEditable},null,40,m),(0,l.Wm)(a,{disabled:!e.isEditable,class:"btn01"},{default:(0,l.w5)((()=>[(0,l._)("span",null,(0,s.zw)(e.$t("common.upload")),1)])),_:1},8,["disabled"])])])])])])])])}var I=t(43493),b=t(42615),F=t(90987);const y=new F.l;var _=(0,l.aZ)({name:"cib201003ss12",props:{approvalPayload:{type:Object,required:!1},currentTab:{type:String,required:!0}},data(){const e=null,i=null,t=this.$route.query.userID,l=this.$route.query.customerNo,s={fileId:"",filePath:"",transactionDate:""};return{userID:t,getFile:e,getImage:i,fileInfo:s,customerNo:l,attachFile:"",fileName:"",fileSize:"",operationMode:"normal",fileList:[],tempFileList:[],isEditable:!1,isEmptyFile:!1,removeFileButton:!1,isShowPlaceholder:!1}},watch:{async approvalPayload(e){if("CIB201003SS12"==this.currentTab){let i=JSON.parse(e.requestContent);i.fileList.map((e=>{this.fileInfo.fileId=e.fileId,this.fileInfo.filePath=e.filePath}));const t=await this.$file.getFileInfo(this.fileInfo.fileId);this.fileName=t?.data.body.originalFileName,this.operationMode="my-request"==this.approvalType?"read":"my-approval"==this.approvalType?"approval":"normal"}},isEditable(e){this.$emit("isBeingEdited",e)},"fileInfo.fileId":function(e){this.isShowPlaceholder=!e}},computed:{approvalType(){return this.$route.query.approvalType?this.$route.query.approvalType.toString():""}},mounted(){this.getFileList(`${this.userID}`)},methods:{async getFileList(e){const i={userID:e},t=await this.$request.getRequest("CIB20100116",i,!1);if(t.body.list.map((e=>(this.fileList.push({fileId:e.fileId,filePath:e.filePath}),this.fileInfo=e))),this.fileInfo.fileId){const e=await this.$file.getFileInfo(this.fileInfo.fileId);this.fileName=e?.data.body.originalFileName,this.fileInfo.fileId=e?.data.body.fileId}else this.isShowPlaceholder=!0},onClickOperation(e){switch(e){case"edit":this.isEditable=!0,0==this.fileList.length?(this.isShowPlaceholder=!0,this.removeFileButton=!1):this.removeFileButton=!0;break;case"cancel":this.isEditable=!1,this.getFileList(`${this.userID}`),this.removeFileButton=!1;break;case"list":this.$router.push("/corporate-internet-banking/subscription");break;case"submit":this.$dialog.onOpen({content:`${this.$t("message.would_you_like_to_save")}`,dialogMode:"Question",callback:()=>{this.handleUpdateFile(),I.Fy.dismiss()}});break}},handleRemoveFile(){this.fileInfo.fileId="",this.fileInfo.filePath="",this.getFile=null,this.fileName="",this.removeFileButton=!1,this.isShowPlaceholder=!0,this.isEmptyFile=!0},async handleUploadFile(e){this.isEmptyFile=!1;const i=e.target.files,t=i[0];if(this.getFile=t,this.fileName=t.name,t.size>10485760)this.$dialog.onOpen({content:this.$t("message.file_size_must_not_exceed_10MB"),dialogMode:"Warning",callback:()=>{I.Fy.dismiss()}});else{this.removeFileButton=!0;const i=e.target.files,t=i[0];if(t.size>10485760)this.fileName="",this.fileInfo.fileId="",this.$dialog.onOpen({content:this.$t("message.file_size_must_not_exceed_10MB"),dialogMode:"Warning",callback:()=>{I.Fy.dismiss()}});else{this.getFile=t;const e=y.countFileSize(t.size);this.fileSize=e;const i=new FileReader;i.readAsDataURL(t),this.fileName=t.name,this.isShowPlaceholder=!1}const l=document.getElementById("actual-btn");l.value=""}},async handleUpdateFile(){if(null===this.getFile&&this.isEmptyFile)for(let t=0;t<this.fileList.length;t++){await this.$file.updateFileStatus(this.fileList[t].fileId,b.Gk.INACTIVE);for(let e=0;e<this.fileList.length;e++){const i=this.fileList.indexOf(this.fileList[e]);this.fileList.splice(i,1)}}if(null!==this.getFile&&!this.isEmptyFile)if(0==this.fileList.length){const e=await this.$file.uploadFile([this.getFile],"CIB");for(let i=0;i<e.data.body.fileList.length;i++){const t=await this.$file.getFileInfo(e.data.body.fileList[i].fileId);this.fileList.push({filePath:t.data.body.filePath,fileId:e.data.body.fileList[i].fileId})}}else if(this.fileList.length>0){const e=await this.$file.uploadFile([this.getFile],"CIB");for(let i=0;i<this.fileList.length;i++){await this.$file.updateFileStatus(this.fileList[i].fileId,b.Gk.INACTIVE);for(let t=0;t<e.data.body.fileList.length;t++)await this.$file.getFileInfo(e.data.body.fileList[t].fileId).then((l=>Object.assign(this.fileList[i],{fileId:e.data.body.fileList[t].fileId,filePath:l.data.body.filePath})))}}const e={userID:`${this.userID}`,customerNo:`${this.customerNo}`,fileList:this.fileList},i=await this.$request.getRequest("CIB2010033A",e,!1,"CIB201003SS12");this.approvalType&&(this.isEditable=!1,this.removeFileButton=!1,this.$emit("isReseTButton",!1)),i.header.result?(this.isEditable=!1,this.removeFileButton=!1,this.$emit("isReseTButton",!1),this.$dialog.onOpen({content:this.$t("message.update_success"),dialogMode:"Success",callback:()=>{I.Fy.dismiss()}})):console.log(i.header.error_text)}}}),v=t(83744);const w=(0,v.Z)(_,[["render",g],["__scopeId","data-v-6db68bad"]]);var $=w}}]);
//# sourceMappingURL=9810.c26be784.js.map